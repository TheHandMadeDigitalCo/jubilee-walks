!function(){"use strict";const Map=window.mapboxgl.Map,AttributionControl=window.mapboxgl.AttributionControl,GeolocateControl=window.mapboxgl.GeolocateControl,NavigationControl=window.mapboxgl.NavigationControl;class WalkMap{constructor(container,host){this._loaded=!1,this._map=new Map({container:container,style:"https://api.maptiler.com/maps/bright/style.json?key=Ufz2DspPpwHKhct0Kj6J",center:[-2.017322,50.774277],zoom:14,minZoom:12,maxZoom:19,pitch:0,hash:!0,attributionControl:!1}),this._map.addControl(new GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})),this._map.addControl(new NavigationControl,"top-right"),this._map.addControl(new AttributionControl({}),"bottom-left"),this._map.on("load",(()=>{this._loaded=!0}))}get map(){return this._map}addTrail(trailSource){const fn=()=>{this._map.addSource(trailSource.id,trailSource.source),this._map.addLayer(trailSource.layer),this._map.addLayer(trailSource.symbols)};this._loaded?fn.call():this._map.on("load",fn)}toggleTrail(layer,enabled){this._map.setLayoutProperty(layer,"visibility",enabled?"visible":"none"),this._map.setLayoutProperty(layer+"-symbols","visibility",enabled?"visible":"none")}}class TrailSource{constructor(url,colour,name){this._id=(()=>{let seed=Date.now();return window.performance&&"function"==typeof window.performance.now&&(seed+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(c=>{let r=(seed+16*Math.random())%16|0;return seed=Math.floor(seed/16),("x"===c?r:11&r).toString(16)}))})(),this._name=name,this._colour=colour,this._source={type:"geojson",data:url},this._layer={id:this._id,type:"line",source:this._id,layout:{"line-join":"round","line-cap":"round",visibility:"none"},paint:{"line-color":colour,"line-width":2.5,"line-dasharray":[3,3],"line-opacity":1}},this._symbols={id:this._id+"-symbols",source:this._id,type:"symbol",layout:{"text-font":["Noto Sans Regular"],"text-size":14,"symbol-placement":"line","text-field":"{name}",visibility:"none"},paint:{"text-color":"white","text-halo-blur":1,"text-halo-color":colour,"text-halo-width":2}}}get id(){return this._id}get layer(){return this._layer}get symbols(){return this._symbols}get source(){return this._source}get colour(){return this._colour}}class ActionButton{constructor(container){this._container=container,this._enabled=!1,this._root=this._render(),this._container.appendChild(this._root),this._root.addEventListener("click",(evt=>{this._enabled=!this._enabled;const event=new CustomEvent("action-toggle",{detail:{enabled:this._enabled}});this._container.dispatchEvent(event)}))}_render(){const root=document.createElement("div");return root.classList.add("control"),root.id="overlay-icon",root.innerHTML="\n            <img src='img/jubilee.svg'>\n        ",root}}class TrailToggleButton{constructor(label,container,layerId,colour){this._label=label,this._container=container,this._layerId=layerId,this._enabled=!1,this._colour=colour,this._root=this._render(),this._container.appendChild(this._root),this._root.addEventListener("click",(evt=>{const icon=this._root.querySelector(".enabled");this._enabled?icon.classList.add("hidden"):icon.classList.remove("hidden"),this._enabled=!this._enabled;const event=new CustomEvent("layer-toggle",{detail:{enabled:this._enabled,layer:this._layerId}});this._container.dispatchEvent(event)}))}_render(){const root=document.createElement("div");return root.classList.add("layer","control","hide"),root.style.backgroundColor=this._colour,root.innerHTML=`\n            <div class='enabled hidden'>\n                <img src='img/circle-check.svg'/>\n            </div>\n            <span>${this._label}</span>\n        `,root}toggle(show){!0===show?(this._root.classList.remove("hide"),this._root.classList.add("show")):(this._root.classList.remove("show"),this._root.classList.add("hide"))}}new class{constructor(){this._walkMap=new WalkMap("map",config.host),this._walks=[new TrailSource("./data/parish.walk.1.geojson","#487bb6","Parish Walk"),new TrailSource("./data/eastend.walk.2.geojson","#958cae","East End Walk"),new TrailSource("./data/heritage.walk.3.geojson","#b78200","Heritage Walk"),new TrailSource("./data/heath.walk.4.geojson","#dc0608","Heath Walk")],this._mobileControls=document.getElementById("mobile-controls"),this._buttons=[new TrailToggleButton("Parish Walk",this._mobileControls,this._walks[0].id,this._walks[0].colour),new TrailToggleButton("East End Walk",this._mobileControls,this._walks[1].id,this._walks[1].colour),new TrailToggleButton("Heritage Walk",this._mobileControls,this._walks[2].id,this._walks[2].colour),new TrailToggleButton("Heath Walk",this._mobileControls,this._walks[3].id,this._walks[3].colour)],this._walks.forEach((walk=>{this._walkMap.addTrail(walk)})),this._actionButton=new ActionButton(this._mobileControls),this._mobileControls.addEventListener("layer-toggle",(evt=>{this._walkMap.toggleTrail(evt.detail.layer,evt.detail.enabled)})),this._mobileControls.addEventListener("action-toggle",(evt=>{this._buttons.forEach((button=>button.toggle(evt.detail.enabled)))}))}}}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlcyI6WyIuLi9zcmMvdWkvbWFwL21hcGxpYnJlLmpzIiwiLi4vc3JjL21hcC5qcyIsIi4uL3NyYy91dGlsLmpzIiwiLi4vc3JjL3VpL2NvbnRyb2xzLmpzIiwiLi4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBNYXAgPSB3aW5kb3cubWFwYm94Z2wuTWFwO1xuZXhwb3J0IGNvbnN0IEF0dHJpYnV0aW9uQ29udHJvbCA9IHdpbmRvdy5tYXBib3hnbC5BdHRyaWJ1dGlvbkNvbnRyb2w7XG5leHBvcnQgY29uc3QgR2VvbG9jYXRlQ29udHJvbCA9IHdpbmRvdy5tYXBib3hnbC5HZW9sb2NhdGVDb250cm9sO1xuZXhwb3J0IGNvbnN0IE5hdmlnYXRpb25Db250cm9sID0gd2luZG93Lm1hcGJveGdsLk5hdmlnYXRpb25Db250cm9sO1xuXG5cbiIsImltcG9ydCB7IEF0dHJpYnV0aW9uQ29udHJvbCwgR2VvbG9jYXRlQ29udHJvbCwgTWFwLCBOYXZpZ2F0aW9uQ29udHJvbCB9IGZyb20gJy4vdWkvbWFwL21hcGxpYnJlJztcbmltcG9ydCB7IHV1aWR2NCB9IGZyb20gJy4vdXRpbCc7XG5cbmNsYXNzIFdhbGtNYXAge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgaG9zdCkge1xuICAgICAgICB0aGlzLl9sb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fbWFwID0gbmV3IE1hcCh7XG4gICAgICAgICAgICBjb250YWluZXI6IGNvbnRhaW5lcixcbiAgICAgICAgICAgIHN0eWxlOiAnaHR0cHM6Ly9hcGkubWFwdGlsZXIuY29tL21hcHMvYnJpZ2h0L3N0eWxlLmpzb24/a2V5PVVmejJEc3BQcHdIS2hjdDBLajZKJyxcbiAgICAgICAgICAgIGNlbnRlcjogWy0yLjAxNzMyMiwgNTAuNzc0Mjc3XSxcbiAgICAgICAgICAgIHpvb206IDE0LFxuICAgICAgICAgICAgbWluWm9vbTogMTIsXG4gICAgICAgICAgICBtYXhab29tOiAxOSxcbiAgICAgICAgICAgIHBpdGNoOiAwLFxuICAgICAgICAgICAgaGFzaDogdHJ1ZSxcbiAgICAgICAgICAgIGF0dHJpYnV0aW9uQ29udHJvbDogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fbWFwLmFkZENvbnRyb2wobmV3IEdlb2xvY2F0ZUNvbnRyb2woe1xuICAgICAgICAgICAgcG9zaXRpb25PcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRyYWNrVXNlckxvY2F0aW9uOiB0cnVlLFxuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMuX21hcC5hZGRDb250cm9sKFxuICAgICAgICAgICAgbmV3IE5hdmlnYXRpb25Db250cm9sKCksXG4gICAgICAgICAgICAndG9wLXJpZ2h0JyxcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5fbWFwLmFkZENvbnRyb2woXG4gICAgICAgICAgICBuZXcgQXR0cmlidXRpb25Db250cm9sKHt9KSxcbiAgICAgICAgICAgICdib3R0b20tbGVmdCcsXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5fbWFwLm9uKCdsb2FkJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZ2V0IG1hcCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcDtcbiAgICB9XG5cbiAgICBhZGRUcmFpbCh0cmFpbFNvdXJjZSkge1xuICAgICAgICBjb25zdCBmbiA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX21hcC5hZGRTb3VyY2UodHJhaWxTb3VyY2UuaWQsIHRyYWlsU291cmNlLnNvdXJjZSk7XG4gICAgICAgICAgICB0aGlzLl9tYXAuYWRkTGF5ZXIodHJhaWxTb3VyY2UubGF5ZXIpO1xuICAgICAgICAgICAgdGhpcy5fbWFwLmFkZExheWVyKHRyYWlsU291cmNlLnN5bWJvbHMpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5fbG9hZGVkKSB7XG4gICAgICAgICAgICBmbi5jYWxsKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9tYXAub24oJ2xvYWQnLCBmbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b2dnbGVUcmFpbChsYXllciwgZW5hYmxlZCkge1xuICAgICAgICB0aGlzLl9tYXAuc2V0TGF5b3V0UHJvcGVydHkoXG4gICAgICAgICAgICBsYXllciwgJ3Zpc2liaWxpdHknLCBlbmFibGVkID8gJ3Zpc2libGUnIDogJ25vbmUnXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuX21hcC5zZXRMYXlvdXRQcm9wZXJ0eShcbiAgICAgICAgICAgIGxheWVyICsgXCItc3ltYm9sc1wiLCAndmlzaWJpbGl0eScsIGVuYWJsZWQgPyAndmlzaWJsZScgOiAnbm9uZSdcbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmNsYXNzIFRyYWlsU291cmNlIHtcbiAgICBjb25zdHJ1Y3Rvcih1cmwsIGNvbG91ciwgbmFtZSkge1xuICAgICAgICB0aGlzLl9pZCA9IHV1aWR2NCgpO1xuICAgICAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5fY29sb3VyID0gY29sb3VyO1xuICAgICAgICB0aGlzLl9zb3VyY2UgPSB7XG4gICAgICAgICAgICB0eXBlOiAnZ2VvanNvbicsXG4gICAgICAgICAgICBkYXRhOiB1cmwsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX2xheWVyID0ge1xuICAgICAgICAgICAgJ2lkJzogdGhpcy5faWQsXG4gICAgICAgICAgICAndHlwZSc6ICdsaW5lJyxcbiAgICAgICAgICAgICdzb3VyY2UnOiB0aGlzLl9pZCxcbiAgICAgICAgICAgICdsYXlvdXQnOiB7XG4gICAgICAgICAgICAgICAgJ2xpbmUtam9pbic6ICdyb3VuZCcsXG4gICAgICAgICAgICAgICAgJ2xpbmUtY2FwJzogJ3JvdW5kJyxcbiAgICAgICAgICAgICAgICAndmlzaWJpbGl0eSc6ICdub25lJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAncGFpbnQnOiB7XG4gICAgICAgICAgICAgICAgJ2xpbmUtY29sb3InOiBjb2xvdXIsXG4gICAgICAgICAgICAgICAgJ2xpbmUtd2lkdGgnOiAyLjUsXG4gICAgICAgICAgICAgICAgJ2xpbmUtZGFzaGFycmF5JzogW1xuICAgICAgICAgICAgICAgICAgICAzLFxuICAgICAgICAgICAgICAgICAgICAzLFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgJ2xpbmUtb3BhY2l0eSc6IDEsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9zeW1ib2xzID0ge1xuICAgICAgICAgICAgJ2lkJzogdGhpcy5faWQgKyBcIi1zeW1ib2xzXCIsXG4gICAgICAgICAgICAnc291cmNlJzogdGhpcy5faWQsXG4gICAgICAgICAgICBcInR5cGVcIjogXCJzeW1ib2xcIixcbiAgICAgICAgICAgIFwibGF5b3V0XCI6IHtcbiAgICAgICAgICAgICAgICBcInRleHQtZm9udFwiOiBbXCJOb3RvIFNhbnMgUmVndWxhclwiXSxcbiAgICAgICAgICAgICAgICBcInRleHQtc2l6ZVwiOiAxNCxcbiAgICAgICAgICAgICAgICBcInN5bWJvbC1wbGFjZW1lbnRcIjogXCJsaW5lXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0LWZpZWxkXCI6ICd7bmFtZX0nLFxuICAgICAgICAgICAgICAgICd2aXNpYmlsaXR5JzogJ25vbmUnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwicGFpbnRcIjoge1xuICAgICAgICAgICAgICAgIFwidGV4dC1jb2xvclwiOiBcIndoaXRlXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0LWhhbG8tYmx1clwiOiAxLFxuICAgICAgICAgICAgICAgIFwidGV4dC1oYWxvLWNvbG9yXCI6IGNvbG91cixcbiAgICAgICAgICAgICAgICBcInRleHQtaGFsby13aWR0aFwiOiAyXG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lkO1xuICAgIH1cblxuICAgIGdldCBsYXllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xheWVyO1xuICAgIH1cblxuICAgIGdldCBzeW1ib2xzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3ltYm9scztcbiAgICB9XG5cbiAgICBnZXQgc291cmNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlO1xuICAgIH1cblxuICAgIGdldCBjb2xvdXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb2xvdXI7XG4gICAgfVxuXG59XG5cblxuZXhwb3J0IHsgV2Fsa01hcCwgVHJhaWxTb3VyY2V9O1xuIiwiZXhwb3J0IGNvbnN0IHV1aWR2NCA9ICgpID0+IHtcbiAgICBsZXQgc2VlZCA9IERhdGUubm93KCk7XG4gICAgaWYgKHdpbmRvdy5wZXJmb3JtYW5jZSAmJiB0eXBlb2Ygd2luZG93LnBlcmZvcm1hbmNlLm5vdyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBzZWVkICs9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgIH1cblxuICAgIHJldHVybiAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIChjKSA9PiB7XG4gICAgICAgIGxldCByID0gKHNlZWQgKyBNYXRoLnJhbmRvbSgpICogMTYpICUgMTYgfCAwO1xuICAgICAgICBzZWVkID0gTWF0aC5mbG9vcihzZWVkIC8gMTYpO1xuXG4gICAgICAgIHJldHVybiAoYyA9PT0gJ3gnID8gciA6IHIgJiAoMHgzIHwgMHg4KSkudG9TdHJpbmcoMTYpO1xuICAgIH0pO1xufTtcbiIsImNsYXNzIEFjdGlvbkJ1dHRvbiB7XG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyKSB7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgdGhpcy5fZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yb290ID0gdGhpcy5fcmVuZGVyKCk7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLl9yb290KTtcblxuICAgICAgICB0aGlzLl9yb290LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuXG4gICAgICAgICAgICB0aGlzLl9lbmFibGVkID0gIXRoaXMuX2VuYWJsZWQ7XG5cbiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdhY3Rpb24tdG9nZ2xlJywge1xuICAgICAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiB0aGlzLl9lbmFibGVkXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLl9jb250YWluZXIuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9yZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHJvb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgcm9vdC5jbGFzc0xpc3QuYWRkKCdjb250cm9sJyk7XG4gICAgICAgIHJvb3QuaWQgPSAnb3ZlcmxheS1pY29uJztcbiAgICAgICAgcm9vdC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8aW1nIHNyYz0naW1nL2p1YmlsZWUuc3ZnJz5cbiAgICAgICAgYDtcbiAgICAgICAgcmV0dXJuIHJvb3Q7XG4gICAgfVxufVxuXG5jbGFzcyBUcmFpbFRvZ2dsZUJ1dHRvbiB7XG5cbiAgICBjb25zdHJ1Y3RvcihsYWJlbCwgY29udGFpbmVyLCBsYXllcklkLCBjb2xvdXIpIHtcbiAgICAgICAgdGhpcy5fbGFiZWwgPSBsYWJlbDtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICAgICB0aGlzLl9sYXllcklkID0gbGF5ZXJJZDtcbiAgICAgICAgdGhpcy5fZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jb2xvdXIgPSBjb2xvdXI7XG4gICAgICAgIHRoaXMuX3Jvb3QgPSB0aGlzLl9yZW5kZXIoKTtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuX3Jvb3QpO1xuXG4gICAgICAgIHRoaXMuX3Jvb3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpY29uID0gdGhpcy5fcm9vdC5xdWVyeVNlbGVjdG9yKCcuZW5hYmxlZCcpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIGljb24uY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGljb24uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2VuYWJsZWQgPSAhdGhpcy5fZW5hYmxlZDtcblxuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2xheWVyLXRvZ2dsZScsIHtcbiAgICAgICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdGhpcy5fZW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXI6IHRoaXMuX2xheWVySWQsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLl9jb250YWluZXIuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9yZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHJvb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgcm9vdC5jbGFzc0xpc3QuYWRkKCdsYXllcicsICdjb250cm9sJywgJ2hpZGUnKTtcbiAgICAgICAgcm9vdC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLl9jb2xvdXI7XG4gICAgICAgIHJvb3QuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz0nZW5hYmxlZCBoaWRkZW4nPlxuICAgICAgICAgICAgICAgIDxpbWcgc3JjPSdpbWcvY2lyY2xlLWNoZWNrLnN2ZycvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8c3Bhbj4ke3RoaXMuX2xhYmVsfTwvc3Bhbj5cbiAgICAgICAgYDtcblxuICAgICAgICByZXR1cm4gcm9vdDtcbiAgICB9XG5cbiAgICB0b2dnbGUoc2hvdykge1xuICAgICAgICBpZiAoc2hvdyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgdGhpcy5fcm9vdC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICAgICAgICAgIHRoaXMuX3Jvb3QuY2xhc3NMaXN0LmFkZChcInNob3dcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yb290LmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93XCIpO1xuICAgICAgICAgICAgdGhpcy5fcm9vdC5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKVxuICAgICAgICB9XG4gICAgfVxuXG5cbn1cblxuZXhwb3J0IHsgVHJhaWxUb2dnbGVCdXR0b24gfTtcbmV4cG9ydCB7IEFjdGlvbkJ1dHRvbiB9O1xuIiwiaW1wb3J0IHsgVHJhaWxTb3VyY2UsIFdhbGtNYXAgfSBmcm9tICcuL21hcCc7XG5pbXBvcnQgeyBBY3Rpb25CdXR0b24sIFRyYWlsVG9nZ2xlQnV0dG9uIH0gZnJvbSAnLi91aS9jb250cm9scyc7XG5cbmNsYXNzIEFwcGxpY2F0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5fd2Fsa01hcCA9IG5ldyBXYWxrTWFwKCdtYXAnLCBjb25maWcuaG9zdCk7XG5cbiAgICAgICAgdGhpcy5fd2Fsa3MgPSBbXG4gICAgICAgICAgICBuZXcgVHJhaWxTb3VyY2UoJy4vZGF0YS9wYXJpc2gud2Fsay4xLmdlb2pzb24nLCAnIzQ4N2JiNicsICdQYXJpc2ggV2FsaycpLFxuICAgICAgICAgICAgbmV3IFRyYWlsU291cmNlKCcuL2RhdGEvZWFzdGVuZC53YWxrLjIuZ2VvanNvbicsICcjOTU4Y2FlJywgJ0Vhc3QgRW5kIFdhbGsnKSxcbiAgICAgICAgICAgIG5ldyBUcmFpbFNvdXJjZSgnLi9kYXRhL2hlcml0YWdlLndhbGsuMy5nZW9qc29uJywgJyNiNzgyMDAnLCAnSGVyaXRhZ2UgV2FsaycpLFxuICAgICAgICAgICAgbmV3IFRyYWlsU291cmNlKCcuL2RhdGEvaGVhdGgud2Fsay40Lmdlb2pzb24nLCAnI2RjMDYwOCcsICdIZWF0aCBXYWxrJyksXG4gICAgICAgIF07XG4gICAgICAgIHRoaXMuX21vYmlsZUNvbnRyb2xzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vYmlsZS1jb250cm9scycpO1xuXG4gICAgICAgIHRoaXMuX2J1dHRvbnMgPSBbXG4gICAgICAgICAgICBuZXcgVHJhaWxUb2dnbGVCdXR0b24oJ1BhcmlzaCBXYWxrJywgdGhpcy5fbW9iaWxlQ29udHJvbHMsIHRoaXMuX3dhbGtzWzBdLmlkLCB0aGlzLl93YWxrc1swXS5jb2xvdXIpLFxuICAgICAgICAgICAgbmV3IFRyYWlsVG9nZ2xlQnV0dG9uKCdFYXN0IEVuZCBXYWxrJywgdGhpcy5fbW9iaWxlQ29udHJvbHMsIHRoaXMuX3dhbGtzWzFdLmlkLCB0aGlzLl93YWxrc1sxXS5jb2xvdXIpLFxuICAgICAgICAgICAgbmV3IFRyYWlsVG9nZ2xlQnV0dG9uKCdIZXJpdGFnZSBXYWxrJywgdGhpcy5fbW9iaWxlQ29udHJvbHMsIHRoaXMuX3dhbGtzWzJdLmlkLCB0aGlzLl93YWxrc1syXS5jb2xvdXIpLFxuICAgICAgICAgICAgbmV3IFRyYWlsVG9nZ2xlQnV0dG9uKCdIZWF0aCBXYWxrJywgdGhpcy5fbW9iaWxlQ29udHJvbHMsIHRoaXMuX3dhbGtzWzNdLmlkLCB0aGlzLl93YWxrc1szXS5jb2xvdXIpLFxuICAgICAgICBdO1xuXG4gICAgICAgIHRoaXMuX3dhbGtzLmZvckVhY2god2FsayA9PiB7XG4gICAgICAgICAgICB0aGlzLl93YWxrTWFwLmFkZFRyYWlsKHdhbGspO1xuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMuX2FjdGlvbkJ1dHRvbiA9IG5ldyBBY3Rpb25CdXR0b24odGhpcy5fbW9iaWxlQ29udHJvbHMpO1xuXG4gICAgICAgIHRoaXMuX21vYmlsZUNvbnRyb2xzLmFkZEV2ZW50TGlzdGVuZXIoJ2xheWVyLXRvZ2dsZScsIChldnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3dhbGtNYXAudG9nZ2xlVHJhaWwoZXZ0LmRldGFpbC5sYXllciwgZXZ0LmRldGFpbC5lbmFibGVkKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fbW9iaWxlQ29udHJvbHMuYWRkRXZlbnRMaXN0ZW5lcignYWN0aW9uLXRvZ2dsZScsIChldnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uLnRvZ2dsZShldnQuZGV0YWlsLmVuYWJsZWQpKTtcbiAgICAgICAgfSlcblxuICAgIH1cbn1cblxuY29uc3QgYXBwID0gbmV3IEFwcGxpY2F0aW9uKCk7XG4iXSwibmFtZXMiOlsiTWFwIiwid2luZG93IiwibWFwYm94Z2wiLCJBdHRyaWJ1dGlvbkNvbnRyb2wiLCJHZW9sb2NhdGVDb250cm9sIiwiTmF2aWdhdGlvbkNvbnRyb2wiLCJXYWxrTWFwIiwiW29iamVjdCBPYmplY3RdIiwiY29udGFpbmVyIiwiaG9zdCIsInRoaXMiLCJfbG9hZGVkIiwiX21hcCIsInN0eWxlIiwiY2VudGVyIiwiem9vbSIsIm1pblpvb20iLCJtYXhab29tIiwicGl0Y2giLCJoYXNoIiwiYXR0cmlidXRpb25Db250cm9sIiwiYWRkQ29udHJvbCIsInBvc2l0aW9uT3B0aW9ucyIsImVuYWJsZUhpZ2hBY2N1cmFjeSIsInRyYWNrVXNlckxvY2F0aW9uIiwib24iLCJtYXAiLCJ0cmFpbFNvdXJjZSIsImZuIiwiYWRkU291cmNlIiwiaWQiLCJzb3VyY2UiLCJhZGRMYXllciIsImxheWVyIiwic3ltYm9scyIsImNhbGwiLCJlbmFibGVkIiwic2V0TGF5b3V0UHJvcGVydHkiLCJUcmFpbFNvdXJjZSIsInVybCIsImNvbG91ciIsIm5hbWUiLCJfaWQiLCJzZWVkIiwiRGF0ZSIsIm5vdyIsInBlcmZvcm1hbmNlIiwicmVwbGFjZSIsImMiLCJyIiwiTWF0aCIsInJhbmRvbSIsImZsb29yIiwidG9TdHJpbmciLCJ1dWlkdjQiLCJfbmFtZSIsIl9jb2xvdXIiLCJfc291cmNlIiwidHlwZSIsImRhdGEiLCJfbGF5ZXIiLCJsYXlvdXQiLCJsaW5lLWpvaW4iLCJsaW5lLWNhcCIsInZpc2liaWxpdHkiLCJwYWludCIsImxpbmUtY29sb3IiLCJsaW5lLXdpZHRoIiwibGluZS1kYXNoYXJyYXkiLCJsaW5lLW9wYWNpdHkiLCJfc3ltYm9scyIsInRleHQtZm9udCIsInRleHQtc2l6ZSIsInN5bWJvbC1wbGFjZW1lbnQiLCJ0ZXh0LWZpZWxkIiwidGV4dC1jb2xvciIsInRleHQtaGFsby1ibHVyIiwidGV4dC1oYWxvLWNvbG9yIiwidGV4dC1oYWxvLXdpZHRoIiwiQWN0aW9uQnV0dG9uIiwiX2NvbnRhaW5lciIsIl9lbmFibGVkIiwiX3Jvb3QiLCJfcmVuZGVyIiwiYXBwZW5kQ2hpbGQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwiZXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImRpc3BhdGNoRXZlbnQiLCJyb290IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJIVE1MIiwiVHJhaWxUb2dnbGVCdXR0b24iLCJsYWJlbCIsImxheWVySWQiLCJfbGFiZWwiLCJfbGF5ZXJJZCIsImljb24iLCJxdWVyeVNlbGVjdG9yIiwicmVtb3ZlIiwiYmFja2dyb3VuZENvbG9yIiwic2hvdyIsIl93YWxrTWFwIiwiY29uZmlnIiwiX3dhbGtzIiwiX21vYmlsZUNvbnRyb2xzIiwiZ2V0RWxlbWVudEJ5SWQiLCJfYnV0dG9ucyIsImZvckVhY2giLCJ3YWxrIiwiYWRkVHJhaWwiLCJfYWN0aW9uQnV0dG9uIiwidG9nZ2xlVHJhaWwiLCJidXR0b24iLCJ0b2dnbGUiXSwibWFwcGluZ3MiOiJ5QkFBTyxNQUFNQSxJQUFNQyxPQUFPQyxTQUFTRixJQUN0QkcsbUJBQXFCRixPQUFPQyxTQUFTQyxtQkFDckNDLGlCQUFtQkgsT0FBT0MsU0FBU0UsaUJBQ25DQyxrQkFBb0JKLE9BQU9DLFNBQVNHLGtCQ0FqRCxNQUFNQyxRQUNGQyxZQUFZQyxVQUFXQyxNQUNuQkMsS0FBS0MsU0FBVSxFQUNmRCxLQUFLRSxLQUFPLElBQUlaLElBQUksQ0FDaEJRLFVBQVdBLFVBQ1hLLE1BQU8sMkVBQ1BDLE9BQVEsRUFBRSxTQUFVLFdBQ3BCQyxLQUFNLEdBQ05DLFFBQVMsR0FDVEMsUUFBUyxHQUNUQyxNQUFPLEVBQ1BDLE1BQU0sRUFDTkMsb0JBQW9CLElBR3hCVixLQUFLRSxLQUFLUyxXQUFXLElBQUlqQixpQkFBaUIsQ0FDdENrQixnQkFBaUIsQ0FDYkMsb0JBQW9CLEdBRXhCQyxtQkFBbUIsS0FFdkJkLEtBQUtFLEtBQUtTLFdBQ04sSUFBSWhCLGtCQUNKLGFBRUpLLEtBQUtFLEtBQUtTLFdBQ04sSUFBSWxCLG1CQUFtQixJQUN2QixlQUdKTyxLQUFLRSxLQUFLYSxHQUFHLFFBQVEsS0FDakJmLEtBQUtDLFNBQVUsS0FJdkJlLFVBQ0ksT0FBT2hCLEtBQUtFLEtBR2hCTCxTQUFTb0IsYUFDTCxNQUFNQyxHQUFLLEtBQ1BsQixLQUFLRSxLQUFLaUIsVUFBVUYsWUFBWUcsR0FBSUgsWUFBWUksUUFDaERyQixLQUFLRSxLQUFLb0IsU0FBU0wsWUFBWU0sT0FDL0J2QixLQUFLRSxLQUFLb0IsU0FBU0wsWUFBWU8sVUFFL0J4QixLQUFLQyxRQUNMaUIsR0FBR08sT0FF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
